UPDATE Promo SET EndDate = DATEADD(SECOND, -86399, EndDate) WHERE datepart(HOUR, EndDate) <> 0 AND EndDate IS NOT NULL;
GO
ALTER VIEW [PromoView] AS SELECT pr.[Id], pr.[Name], mmc.[Name] as MarsMechanicName, mmt.[Name] as MarsMechanicTypeName, pr.[MarsMechanicDiscount], cl.[SystemName] as ColorSystemName, ps.[Color] as PromoStatusColor, ps.[SystemName] as PromoStatusSystemName, pr.[CreatorId], pr.[ClientTreeId], pr.[BaseClientTreeIds], pr.[StartDate], DATEADD(SECOND, 86399, pr.[EndDate]) AS EndDate, pr.[DispatchesStart], pr.[CalendarPriority], pr.[Number], bt.[Name] as BrandTechName, ev.[Name] as EventName FROM [TPM_Dev].[Promo] pr LEFT JOIN PromoStatus ps ON pr.PromoStatusId = ps.Id LEFT JOIN Color cl ON pr.ColorId = cl.Id LEFT JOIN Mechanic mmc ON pr.MarsMechanicId = mmc.Id LEFT JOIN MechanicType mmt ON pr.MarsMechanicTypeId = mmt.Id LEFT JOIN[Event] ev ON pr.EventId = ev.Id LEFT JOIN BrandTech bt ON pr.BrandTechId = bt.Id;
